<div class="card">
  <!-- Üst Kısım: Kontroller -->
  <div class="date-room-controls">
    <!-- Sol Kontroller -->
    <div class="left-controls">
      <div class="control-group">
        <div class="date-picker">
          <label for="startDate">Başlangıç Tarihi</label>
          <p-calendar id="startDate" [(ngModel)]="startDate" (ngModelChange)="onDateRangeChange()"
            [showButtonBar]="true" dateFormat="dd.mm.yy">
          </p-calendar>
        </div>
        <div class="date-picker">
          <label for="endDate">Bitiş Tarihi</label>
          <p-calendar id="endDate" [(ngModel)]="endDate" (ngModelChange)="onDateRangeChange()" [showButtonBar]="true"
            dateFormat="dd.mm.yy">
          </p-calendar>
        </div>
        <div class="room-selector">
          <label for="roomTypes">Oda Tipleri</label>
          <p-multiSelect id="roomTypes" [(ngModel)]="selectedRoomTypes" [options]="availableRoomTypes"
            optionLabel="name" placeholder="Oda Tipleri Seç" (onChange)="updateRoomSelection()">
          </p-multiSelect>
        </div>
      </div>
    </div>

    <!-- Sağ Kontroller -->
    <div class="right-controls">
      <div class="checkbox-group">
        <div class="checkbox-item">
          <p-checkbox [(ngModel)]="showPaxes" binary="true">
          </p-checkbox>
          <label>Paxes</label>
        </div>
        <div class="checkbox-item">
          <p-checkbox [(ngModel)]="stopSales" binary="true">
          </p-checkbox>
          <label>Satışı Durdur</label>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Alt Kısım: Tablo -->
<div *ngIf="displayedDates.length && selectedRoomTypes.length" class="card table-card">
  <p-table [value]="tableData" [scrollable]="true">
    <ng-template pTemplate="header">
      <tr>
        <th>Oda Tipi</th>
        <th *ngFor="let date of displayedDates">{{ date | date: 'dd.MM.yyyy' }}</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-row>
      <tr>
        <td>{{ row.roomType }}</td>
        <td *ngFor="let cell of row.cells">
          <div class="cell-content">
            <!-- Base Fiyat -->
            <div class="input-group">
              <i class="fa fa-euro-sign"></i>
              <p-inputNumber [(ngModel)]="cell.basePrice" [mode]="'currency'" [currency]="'EUR'"
                placeholder="Base Fiyat">
              </p-inputNumber>
            </div>
            <!-- Kontenjan -->
            <div class="input-group">
              <i class="fa fa-bed"></i>
              <p-inputNumber [(ngModel)]="cell.capacity" [min]="0" placeholder="Kontenjan">
              </p-inputNumber>
            </div>
            <!-- Paxes (Gösterim duruma bağlı) -->
            <ng-container *ngIf="showPaxes">
              <div class="input-group" *ngFor="let pax of cell.paxes; let i = index; trackBy: trackByIndex">
                <i class="fa fa-user"></i>
                <p-inputNumber  [ngModelOptions]="{ standalone: true }" [(ngModel)]="cell.paxes[i]" [min]="0" placeholder="{{ i + 1 }} Misafir">
                </p-inputNumber>
              </div>
            </ng-container>
            <!-- Satışı Durdur (Gösterim duruma bağlı) -->
            <ng-container *ngIf="stopSales">
              <div class="input-group">
                <i class="fa fa-ban"></i>
                <p-dropdown [(ngModel)]="cell.stopSales" [options]="stopSalesOptions" placeholder="Satışı Durdur">
                </p-dropdown>
              </div>
            </ng-container>
          </div>
        </td>
      </tr>
    </ng-template>
  </p-table>
  <button pButton label="Kaydet" (click)="saveData()" class="save-button"></button>
</div>